import { google } from 'googleapis'
import constants from '../../constants'

const getSearchResults = async (input: string) => {
	if (constants.test) {
		return [
			{
				kind: 'customsearch#result',
				title:
					'After Effects CC Masterclass: Complete After Effects Course | Udemy',
				htmlTitle:
					'<b>After Effects CC</b> Masterclass: <b>Complete After Effects</b> Course | Udemy',
				link: 'https://www.udemy.com/course/after-effects-cc/',
				displayLink: 'www.udemy.com',
				snippet:
					'Learn Beginner to Advanced Adobe After Effects CC: Motion Graphics, Kinetic Typography, Visual Effects VFX, Animation+.',
				htmlSnippet:
					'Learn Beginner to Advanced Adobe <b>After Effects CC</b>: Motion Graphics, Kinetic Typography, Visual Effects VFX, Animation+.',
				cacheId: 'J_E-WFw7UZEJ',
				formattedUrl: 'https://www.udemy.com/course/after-effects-cc/',
				htmlFormattedUrl:
					'https://www.udemy.com/course/<b>after</b>-<b>effects</b>-<b>cc</b>/',
				pagemap: {
					metatags: [
						{
							'apple-itunes-app':
								'app-id=562413829, affiliate-data=ct=Safari_SmartBanner&amp;pt=1240482',
							'og:image':
								'https://img-c.udemycdn.com/course/480x270/927360_bab9_5.jpg',
							'msapplication-config':
								'/staticx/udemy/images/v7/browserconfig.xml',
							'twitter:card': 'summary_large_image',
							'theme-color': '#ffffff',
							'og:site_name': 'Udemy',
							'udemy_com:instructor':
								'https://www.udemy.com/user/philipebiner2/',
							'twitter:url': 'https://www.udemy.com/course/after-effects-cc/',
							'udemy_com:available': '1',
							medium: 'mult',
							title:
								'After Effects CC Masterclass: Complete After Effects Course',
							'msapplication-tileimage':
								'/staticx/udemy/images/v7/mstile-144x144.png',
							'udemy_com:category': 'Design',
							'og:description':
								'Learn Beginner to Advanced Adobe After Effects CC: Motion Graphics, Kinetic Typography, Visual Effects VFX, Animation+',
							'twitter:image':
								'https://img-c.udemycdn.com/course/480x270/927360_bab9_5.jpg',
							'twitter:site': '@udemy',
							'application-name': 'Udemy',
							'msapplication-tilecolor': '#a435f0',
							'udemy_com:price': '$99.99',
							'og:type': 'udemy_com:course',
							'twitter:title':
								'After Effects CC Masterclass: Complete After Effects Course',
							'twitter:domain': 'www.udemy.com',
							'og:title':
								'After Effects CC Masterclass: Complete After Effects Course',
							'fb:app_id': '313137469260',
							viewport:
								'width=device-width, initial-scale=1.0, minimum-scale=1.0',
							'twitter:description':
								'Learn Beginner to Advanced Adobe After Effects CC: Motion Graphics, Kinetic Typography, Visual Effects VFX, Animation+',
							'og:locale': 'en_US',
							'og:url': 'https://www.udemy.com/course/after-effects-cc/',
							'google-play-app': 'app-id=com.udemy.android',
						},
					],
					cse_image: [
						{
							src: 'https://img-c.udemycdn.com/course/480x270/927360_bab9_5.jpg',
						},
					],
				},
			},
			{
				kind: 'customsearch#result',
				title: 'Learn After Effect CC - The Complete Guide for Beginners',
				htmlTitle:
					'Learn <b>After Effect CC - The Complete Guide</b> for Beginners',
				link: 'https://www.eduonix.com/after-effects-cc-the-complete-guide-to-after-effects-cc',
				displayLink: 'www.eduonix.com',
				snippet:
					'In this after effects cc tutorial, you will learn how to add visual effects & motion graphics to your video. Enroll in this course & create your best videosÂ ...',
				htmlSnippet:
					'In this <b>after effects cc tutorial</b>, you will learn how to add visual effects &amp; motion graphics to your video. Enroll in this course &amp; create your best videos&nbsp;...',
				cacheId: '0bWIxK_I4SMJ',
				formattedUrl:
					'https://www.eduonix.com/after-effects-cc-the-complete-guide-to-after-effects -cc',
				htmlFormattedUrl:
					'https://www.eduonix.com/<b>after</b>-<b>effects</b>-<b>cc-the-complete</b>-<b>guide-to-after</b>-<b>effects</b> -<b>cc</b>',
				pagemap: {
					cse_thumbnail: [
						{
							src: 'https://encrypted-tbn2.gstatic.com/images?q=tbn:ANd9GcTLT1U6RrcC6trh53V95qpEY7X7BcbYjef_5aKWjwRZalXOtWAkgbXCX2fv',
							width: '278',
							height: '181',
						},
					],
					metatags: [
						{
							'p:domain_verify': 'a12c40453866485ea24761668cb64d70',
							'og:image':
								'https://cdn.eduonix.com/assets/images/header_img/2018052303204910780.jpg',
							'og:type':
								'In this after effects cc tutorial, you will learn how to add visual effects & motion graphics to your video. Enroll in this course & create your best videos now',
							'og:image:width': '800',
							'og:site_name': 'www.eduonix.com',
							'og:title':
								'Learn After Effect CC - The Complete Guide for Beginners',
							'amp-google-client-id-api': 'gtag',
							'og:image:height': '500',
							title: 'Learn After Effect CC - The Complete Guide for Beginners',
							'og:description':
								'In this after effects cc tutorial, you will learn how to add visual effects & motion graphics to your video. Enroll in this course & create your best videos now',
							'facebook-domain-verification': 'ugzkd9dzzvxjit6fphog44z47oomzn',
							referrer: 'no-referrer-when-downgrade',
							'fb:app_id': '719962838147500',
							viewport:
								'width=device-width, initial-scale=1.0,maximum-scale=1.0, minimum-scale=1.0, user-scalable=no',
							'og:url':
								'https://www.eduonix.com/after-effects-cc-the-complete-guide-to-after-effects-cc',
						},
					],
					cse_image: [
						{
							src: 'https://cdn.eduonix.com/assets/images/header_img/2018052303204910780.jpg',
						},
					],
				},
			},
			{
				kind: 'customsearch#result',
				title: 'After Effects CC Class: Complete Course | Udemy',
				htmlTitle:
					'<b>After Effects CC</b> Class: <b>Complete</b> Course | Udemy',
				link: 'https://www.udemy.com/course/after-effects-kinetic-typography/',
				displayLink: 'www.udemy.com',
				snippet:
					'Jun 4, 2022 ... Adobe After Effects CC Create stunning Motion Graphics, VFX Visual Effects & VFX Compositing with 50+ practice projects.',
				htmlSnippet:
					'Jun 4, 2022 <b>...</b> Adobe <b>After Effects CC</b> Create stunning Motion Graphics, VFX Visual Effects &amp; VFX Compositing with 50+ practice projects.',
				cacheId: 'EMT6jJtxIVgJ',
				formattedUrl:
					'https://www.udemy.com/course/after-effects-kinetic-typography/',
				htmlFormattedUrl:
					'https://www.udemy.com/course/<b>after</b>-<b>effects</b>-kinetic-typography/',
				pagemap: {
					metatags: [
						{
							'apple-itunes-app':
								'app-id=562413829, affiliate-data=ct=Safari_SmartBanner&amp;pt=1240482',
							'og:image':
								'https://img-c.udemycdn.com/course/480x270/627730_83d0_33.jpg',
							'msapplication-config':
								'/staticx/udemy/images/v7/browserconfig.xml',
							'twitter:card': 'summary_large_image',
							'theme-color': '#ffffff',
							'og:site_name': 'Udemy',
							'udemy_com:instructor':
								'https://www.udemy.com/user/ultimateresults/',
							'twitter:url':
								'https://www.udemy.com/course/after-effects-kinetic-typography/',
							'udemy_com:available': '1',
							medium: 'mult',
							title: 'After Effects CC Class: Complete Course',
							'msapplication-tileimage':
								'/staticx/udemy/images/v7/mstile-144x144.png',
							'udemy_com:category': 'Design',
							'og:description':
								'Adobe After Effects CC Create stunning Motion Graphics, VFX Visual Effects & VFX Compositing with 50+ practice projects.',
							'twitter:image':
								'https://img-c.udemycdn.com/course/480x270/627730_83d0_33.jpg',
							'twitter:site': '@udemy',
							'application-name': 'Udemy',
							'msapplication-tilecolor': '#a435f0',
							'udemy_com:price': '$199.99',
							'og:type': 'udemy_com:course',
							'twitter:title': 'After Effects CC Class: Complete Course',
							'twitter:domain': 'www.udemy.com',
							'og:title': 'After Effects CC Class: Complete Course',
							'fb:app_id': '313137469260',
							viewport:
								'width=device-width, initial-scale=1.0, minimum-scale=1.0',
							'twitter:description':
								'Adobe After Effects CC Create stunning Motion Graphics, VFX Visual Effects & VFX Compositing with 50+ practice projects.',
							'og:locale': 'en_US',
							'og:url':
								'https://www.udemy.com/course/after-effects-kinetic-typography/',
							'google-play-app': 'app-id=com.udemy.android',
						},
					],
					creativework: [
						{
							datemodified: '2022-06-04T08:24:05Z',
						},
					],
					cse_image: [
						{
							src: 'https://img-c.udemycdn.com/course/480x270/627730_83d0_33.jpg',
						},
					],
				},
			},
		]
	}
	const googleKey = constants.googleKey
	const search = google.customsearch({
		auth: googleKey,
		version: 'v1',
	})

	const searchResult = (
		await search.cse.list({
			cx: constants.cx,
			q: input,
		})
	).data.items

	return searchResult.slice(0, constants.searchResults)
}

export default async function handler(req, res) {
	const input = req.query['search']
	res.status(200).json({ search_results: await getSearchResults(input) })
}
